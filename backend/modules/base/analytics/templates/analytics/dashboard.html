{% extends "base.html" %}

{% block title %}Analytics Dashboard | DAEMON-ONE{% endblock %}

{% block content %}
<div class="docs-page">
    <div class="docs-container" style="max-width: 1100px;">
        <a href="/" class="back-link">â† Back to Home</a>

        <header style="padding: 2rem 0; margin-bottom: 2rem;">
            <div class="docs-badge">ğŸ“Š Admin Only</div>
            <h1 class="docs-title">Analytics <span class="gradient-text">Dashboard</span></h1>
            <p class="docs-subtitle">Monitor traffic, performance, and database health.</p>
        </header>

        <!-- Stats Cards -->
        <div class="features-grid" style="margin-bottom: 2rem;">
            <div class="feature-card">
                <div class="feature-icon">ğŸ‘ï¸</div>
                <h3 class="feature-title">Page Views</h3>
                <p style="font-size: 2rem; font-weight: 700; margin: 0;">{{ stats.total_views }}</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ‘¤</div>
                <h3 class="feature-title">Unique Visitors</h3>
                <p style="font-size: 2rem; font-weight: 700; margin: 0;">{{ stats.unique_visitors }}</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">âš¡</div>
                <h3 class="feature-title">Avg Response</h3>
                <p style="font-size: 2rem; font-weight: 700; margin: 0;">{{ stats.avg_response_time_ms }}ms</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ—„ï¸</div>
                <h3 class="feature-title">DB Connections</h3>
                <p style="font-size: 2rem; font-weight: 700; margin: 0;">{{ db_stats.connection_count }}</p>
            </div>
        </div>

        <!-- Database Section -->
        <section class="glass-card" style="padding: 1.5rem; margin-bottom: 2rem;">
            <h2 style="font-size: 1.25rem; margin-bottom: 1rem;">ğŸ—„ï¸ Database Tables</h2>
            
            <div 
                hx-get="/analytics/database/"
                hx-trigger="every {{ refresh_interval }}s"
                hx-swap="innerHTML"
            >
                {% include "analytics/_database_stats.html" %}
            </div>
        </section>

        <!-- Slow Queries Section -->
        <section class="glass-card" style="padding: 1.5rem;">
            <h2 style="font-size: 1.25rem; margin-bottom: 1rem;">ğŸ¢ Slow Queries</h2>
            
            <div 
                hx-get="/analytics/slow-queries/"
                hx-trigger="every {{ refresh_interval }}s"
                hx-swap="innerHTML"
            >
                {% include "analytics/_slow_queries.html" %}
            </div>
        </section>

        <p style="text-align: center; color: var(--text-muted); margin-top: 2rem; font-size: 0.8rem;">
            Auto-refreshing every {{ refresh_interval }} seconds
        </p>
    </div>
</div>
{% endblock %}
